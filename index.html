<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shadow Shapes - ç¬¬37å¼¾</title>
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; overflow: hidden; background: #f3e5f5; font-family: sans-serif; touch-action: none; position: fixed; width: 100%; height: 100%; }
        
        /* åºƒå‘Šæ ï¼š100px */
        #ad-top, #ad-bottom { position: fixed; left: 0; width: 100%; height: 100px; background: #333; z-index: 100; display: flex; align-items: center; justify-content: center; }
        #ad-top { top: 0; } #ad-bottom { bottom: 0; }
        iframe { border: none; width: 100%; height: 100px; }

        /* ã‚²ãƒ¼ãƒ æœ¬ä½“ã‚¨ãƒªã‚¢ */
        #game-outer { position: absolute; top: 100px; bottom: 100px; left: 0; right: 0; background: #f3e5f5; overflow: hidden; display: flex; flex-direction: column; }
        #main-container { height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 10px; position: relative; }
        
        #ui-layer { width: 100%; display: flex; justify-content: space-around; padding: 5px 0; z-index: 10; }
        .ui-box { padding: 4px 15px; border-radius: 15px; font-weight: bold; font-size: 16px; color: #7b1fa2; background: white; box-shadow: 0 2px #ce93d8; }

        /* ãŠé¡Œã®å›³å½¢ */
        #target-display { font-size: 70px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.1)); transition: transform 0.3s; margin: 20px 0; }

        /* é¸æŠè‚¢ã®ã‚·ãƒ«ã‚¨ãƒƒãƒˆ */
        #choices { display: flex; gap: 12px; padding: 10px; justify-content: center; width: 100%; }
        .choice-btn { 
            width: 75px; height: 75px; background: #ffffff; 
            border-radius: 15px; display: flex; align-items: center; justify-content: center; 
            font-size: 36px; cursor: pointer; box-shadow: 0 4px #ce93d8; border: 2px solid #7b1fa2;
            -webkit-tap-highlight-color: transparent;
        }
        .choice-btn:active { transform: translateY(2px); box-shadow: 0 2px #ce93d8; }
        
        /* ã‚·ãƒ«ã‚¨ãƒƒãƒˆåŒ– */
        .silhouette { filter: brightness(0); }

        /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ï¼šã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œ */
        #menuScreen { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(255,255,255,0.96); display: flex; flex-direction: column; 
            align-items: center; justify-content: flex-start; z-index: 50; 
            padding: 5px 0; overflow-y: auto; -webkit-overflow-scrolling: touch;
        }

        #ad-middle-container { width: 300px; height: 120px; background: #000; margin: 5px 0; display: none; justify-content: center; align-items: center; overflow: hidden; flex-shrink: 0; }

        .menu-btn-group { display: flex; flex-direction: column; align-items: center; width: 100%; gap: 8px; padding-bottom: 20px; }
        .menu-btn { width: 220px; padding: 12px; font-size: 18px; border: none; border-radius: 30px; font-weight: bold; cursor: pointer; text-decoration: none; text-align: center; }
        #retry-btn { background: #9c27b0; color: white; box-shadow: 0 4px #7b1fa2; }
        #more-games-btn { background: #ff4081; color: white; box-shadow: 0 4px #c2185b; }
    </style>
</head>
<body>

    <div id="ad-top"><iframe id="frame-top" src="ad.html"></iframe></div>

    <div id="game-outer">
        <div id="main-container">
            <div id="ui-layer">
                <div id="score-display" class="ui-box">SCORE: 0</div>
                <div id="timer-display" class="ui-box">TIME: 5.0</div>
            </div>
            
            <div style="font-weight:bold; color:#7b1fa2; margin-top: 10px; font-size: 14px;">åŒã˜å½¢ã®ã€Œå½±ã€ã‚’é¸ã¹ï¼</div>
            <div id="target-display">â“</div>
            <div id="choices"></div>

            <div id="menuScreen">
                <h2 id="result-msg" style="color:#7b1fa2; margin: 10px 0; font-size: 24px;">Shadow Shapes</h2>
                <p style="font-size: 13px; color: #666; margin: 0; text-align: center;">ã‚«ãƒ©ãƒ¼ã®å›³å½¢ã¨åŒã˜å½¢ã®å½±ã‚’ã‚¿ãƒƒãƒ—ï¼</p>
                
                <div id="ad-middle-container">
                    <script src="https://adm.shinobi.jp/s/1e6de436ea850948e238e975a93767eb"></script>
                </div>

                <div class="menu-btn-group">
                    <button id="retry-btn" class="menu-btn" onclick="startNewGame()">ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
                    <a href="https://saaaachi.github.io/" id="more-games-btn" class="menu-btn">ä»–ã®ã‚²ãƒ¼ãƒ ã¯ã“ã¡ã‚‰</a>
                </div>
            </div>
        </div>
    </div>

    <div id="ad-bottom"><iframe id="frame-bottom" src="ad.html"></iframe></div>

    <script>
        let score = 0, gameActive = false, timeLeft = 5.0, timer;
        const shapes = ['â­', 'â¤ï¸', 'ğŸŒ™', 'â˜ï¸', 'â˜€ï¸', 'ğŸŒ¸', 'ğŸ’', 'ğŸ€', 'ğŸ', 'ğŸ±', 'ğŸ¦‹', 'ğŸ˜', 'ğŸ ', 'ğŸš—', 'ğŸ””', 'ğŸ€'];
        let targetShape = "";

        const menuScreen = document.getElementById("menuScreen");
        const adMid = document.getElementById("ad-middle-container");
        const resultMsg = document.getElementById("result-msg");
        const retryBtn = document.getElementById("retry-btn");
        const targetDisplay = document.getElementById("target-display");
        const choicesDiv = document.getElementById("choices");

        function startNewGame() {
            menuScreen.style.display = "none";
            adMid.style.display = "none";
            score = 0; gameActive = true;
            nextLevel();
        }

        function nextLevel() {
            if(!gameActive) return;
            timeLeft = Math.max(1.1, 5.0 - (score * 0.18));
            updateUI();
            
            targetShape = shapes[Math.floor(Math.random() * shapes.length)];
            targetDisplay.innerText = targetShape;
            
            // ãŠé¡Œã‚’ãƒ©ãƒ³ãƒ€ãƒ å›è»¢
            const rotations = [0, 90, 180, 270];
            targetDisplay.style.transform = `rotate(${rotations[Math.floor(Math.random()*4)]}deg)`;

            choicesDiv.innerHTML = "";
            const currentChoices = [targetShape];
            while(currentChoices.length < 3) {
                const s = shapes[Math.floor(Math.random() * shapes.length)];
                if(!currentChoices.includes(s)) currentChoices.push(s);
            }
            currentChoices.sort(() => Math.random() - 0.5);

            currentChoices.forEach(s => {
                const btn = document.createElement("button");
                btn.className = "choice-btn";
                btn.innerHTML = `<span class="silhouette">${s}</span>`;
                btn.onclick = () => check(s);
                choicesDiv.appendChild(btn);
            });

            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft -= 0.1;
                updateUI();
                if(timeLeft <= 0) gameOver("æ™‚é–“åˆ‡ã‚Œï¼â³");
            }, 100);
        }

        function check(s) {
            if(!gameActive) return;
            if(s === targetShape) {
                score++;
                nextLevel();
            } else {
                gameOver("å½¢ãŒã¡ãŒã†ã‚ˆï¼ğŸ˜±");
            }
        }

        function updateUI() {
            document.getElementById("score-display").innerText = "SCORE: " + score;
            document.getElementById("timer-display").innerText = "TIME: " + Math.max(0, timeLeft).toFixed(1);
        }

        function gameOver(msg) {
            gameActive = false;
            clearInterval(timer);
            resultMsg.innerText = msg + "\nSCORE: " + score;
            retryBtn.innerText = "ã‚‚ã†ä¸€åº¦éŠã¶";
            adMid.style.display = "flex";
            menuScreen.style.display = "flex";
            menuScreen.scrollTop = 0;
        }

        function refreshAds() {
            const t = document.getElementById('frame-top');
            const b = document.getElementById('frame-bottom');
            if(t) t.src = t.src;
            if(b) b.src = b.src;
        }
        setInterval(refreshAds, 30000);

        window.onload = () => { menuScreen.style.display = "flex"; };
    </script>
</body>
</html>
